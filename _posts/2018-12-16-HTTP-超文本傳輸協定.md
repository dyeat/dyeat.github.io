---
layout: post
title: "HTTP-超文本傳輸協定"
date: 2018-12-16 23:05:36 +0800
categories: [web]
tags: [web]
---

### 超文本傳輸協定 

```
超文本傳輸協定（英語：HyperText Transfer Protocol，縮寫：HTTP）是一種用於分佈式、協作式和超媒體資訊系統的應用層協定。
HTTP是全球資訊網的資料通訊的基礎
```


### 協定概述
```
在網頁瀏覽器的網址列上顯示HTTP網路協定的插圖
在網頁瀏覽器的網址列上顯示HTTP網路協定的插圖
HTTP是一個用戶端終端（用戶）和伺服器端（網站）請求和應答的標準（TCP）。通過使用網頁瀏覽器、網路爬蟲或者其它的工具，用戶端發起一個HTTP請求到伺服器上指定埠（預設埠為80）。我們稱這個用戶端為用戶代理程式（user agent）。應答的伺服器上儲存著一些資源，比如HTML檔案和圖像。我們稱這個應答伺服器為源伺服器（origin server）。在用戶代理和源伺服器中間可能存在多個「中間層」，比如代理伺服器、閘道器或者隧道（tunnel）。

儘管TCP/IP協定是網際網路上最流行的應用，HTTP協定中，並沒有規定必須使用它或它支援的層。事實上，HTTP可以在任何網際網路協定上，或其他網路上實現。HTTP假定其下層協定提供可靠的傳輸。因此，任何能夠提供這種保證的協定都可以被其使用。因此也就是其在TCP/IP協定族使用TCP作為其傳輸層。

通常，由HTTP用戶端發起一個請求，建立一個到伺服器指定埠（預設是80埠）的TCP連接。HTTP伺服器則在那個埠監聽用戶端的請求。一旦收到請求，伺服器會向用戶端返回一個狀態，比如"HTTP/1.1 200 OK"，以及返回的內容，如請求的檔案、錯誤訊息、或者其它資訊。
```

### 請求方法
**HTTP/1.1協定中共定義了八種方法（也叫「動作」）來以不同方式操作指定的資源：**

```
GET
向指定的資源發出「顯示」請求。使用GET方法應該只用在讀取資料，而不應當被用於產生「副作用」的操作中，例如在Web Application中。其中一個原因是GET可能會被網路蜘蛛等隨意存取。參見安全方法

HEAD
與GET方法一樣，都是向伺服器發出指定資源的請求。只不過伺服器將不傳回資源的本文部份。它的好處在於，使用這個方法可以在不必傳輸全部內容的情況下，就可以取得其中「關於該資源的資訊」（元資訊或稱元資料）。

POST
向指定資源提交資料，請求伺服器進行處理（例如提交表單或者上傳檔案）。資料被包含在請求本文中。這個請求可能會建立新的資源或修改現有資源，或二者皆有。

PUT
向指定資源位置上傳其最新內容。

DELETE
請求伺服器刪除Request-URI所標識的資源。

TRACE
回顯伺服器收到的請求，主要用於測試或診斷。

OPTIONS
這個方法可使伺服器傳回該資源所支援的所有HTTP請求方法。用'*'來代替資源名稱，向Web伺服器傳送OPTIONS請求，可以測試伺服器功能是否正常運作。

CONNECT
HTTP/1.1協定中預留給能夠將連接改為管道方式的代理伺服器。通常用於SSL加密伺服器的連結（經由非加密的HTTP代理伺服器）。
```

方法名稱是區分大小寫的。當某個請求所針對的資源不支援對應的請求方法的時候，伺服器應當返回狀態碼`405（Method Not Allowed）`，當伺服器不認識或者不支援對應的請求方法的時候，應當返回狀態碼`501（Not Implemented）`。

`HTTP`伺服器至少應該實現`GET`和`HEAD`方法，其他方法都是可選的。當然，所有的方法支援的實現都應當符合下述的方法各自的語意定義。此外，除了上述方法，特定的HTTP伺服器還能夠擴充自訂的方法。
<br />
例如：

PATCH（由 [RFC 5789](https://tools.ietf.org/html/rfc5789) 指定的方法）
用於將局部修改應用到資源。

### 安全方法
對於`GET`和`HEAD`方法而言，除了進行取得資源資訊外，這些請求不應當再有其他意義。也就是說，這些方法應當被認為是「安全的」。 用戶端可能會使用其他「非安全」方法，例如`POST`，`PUT`及`DELETE`，應該以特殊的方式（通常是按鈕而不是超連結）告知客戶可能的後果（例如一個按鈕控制的資金交易），或請求的操作可能是不安全的（例如某個檔案將被上傳或刪除）。

但是，不能想當然地認為伺服器在處理某個GET請求時不會產生任何副作用。事實上，很多動態資源會把這作為其特性。這裡重要的區別在於用戶並沒有請求這一副作用，因此不應由用戶為這些副作用承擔責任。

### 版本
超文本傳輸協定已經演化出了很多版本，它們中的大部分都是向下相容的。在 [RFC 2145](https://tools.ietf.org/html/rfc2145)中描述了HTTP版本號的用法。用戶端在請求的開始告訴伺服器它採用的協定版本號，而後者則在回應中採用相同或者更早的協定版本。

```
HTTP/0.9
已過時。只接受GET一種請求方法，沒有在通訊中指定版本號，且不支援請求頭。由於該版本不支援POST方法，因此用戶端無法向伺服器傳遞太多資訊。

HTTP/1.0
這是第一個在通訊中指定版本號的HTTP協定版本，至今仍被廣泛採用，特別是在代理伺服器中。

HTTP/1.1
持久連接被預設採用，並能很好地配合代理伺服器工作。還支援以管道方式在同時傳送多個請求，以便降低線路負載，提高傳輸速度。


```
### HTTP/1.1相較於HTTP/1.0協定的區別主要體現在：

- 快取處理
- 頻寬最佳化及網路連接的使用
- 錯誤通知的管理
- 訊息在網路中的傳送
- 網際網路位址的維護
- 安全性及完整性


### HTTP/2

目前版本，於2015年5月作為網際網路標準正式發布。



### 狀態碼

參見：HTTP狀態碼

所有HTTP回應的第一行都是狀態行，依次是當前HTTP版本號，3位數字組成的狀態程式碼，以及描述狀態的短語，彼此由空格分隔。

狀態程式碼的第一個數字代表當前回應的類型：

- [1xx](https://www.wikiwand.com/zh-tw/HTTP%E7%8A%B6%E6%80%81%E7%A0%81#1xx%E6%B6%88%E6%81%AF)訊息——請求已被伺服器接收，繼續處理
- [2xx](https://www.wikiwand.com/zh-tw/HTTP%E7%8A%B6%E6%80%81%E7%A0%81#2xx%E6%88%90%E5%8A%9F)成功——請求已成功被伺服器接收、理解、並接受
- [3xx](https://www.wikiwand.com/zh-tw/HTTP%E7%8A%B6%E6%80%81%E7%A0%81#3xx%E9%87%8D%E5%AE%9A%E5%90%91)重新導向——需要後續操作才能完成這一請求
- [4xx](https://www.wikiwand.com/zh-tw/HTTP%E7%8A%B6%E6%80%81%E7%A0%81#4xx%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF)請求錯誤——請求含有詞法錯誤或者無法被執行
- [5xx](https://www.wikiwand.com/zh-tw/HTTP%E7%8A%B6%E6%80%81%E7%A0%81#5xx%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%94%99%E8%AF%AF)伺服器錯誤——伺服器在處理某個正確請求時發生錯誤
雖然 [RFC 2616](https://tools.ietf.org/html/rfc2616) 中已經推薦了描述狀態的短語，例如"200 OK"，"[404 Not Found](https://www.wikiwand.com/zh-tw/HTTP_404)"，但是WEB開發者仍然能夠自行決定採用何種短語，用以顯示在地化的狀態描述或者自訂資訊。

--- 

### 協定例子
下面是一個HTTP用戶端與伺服器之間對談的例子，執行於www.google.com，埠80


### 請求資訊
發出的請求資訊（message request）包括以下幾個:

- 請求行（例如GET /images/logo.gif HTTP/1.1，表示從/images目錄下請求logo.gif這個檔案）
- 請求頭（例如Accept-Language: en）
- 空行
- 其他訊息體

請求行和標題必須以<CR><LF>作為結尾。空行內必須只有<CR><LF>而無其他空格。在HTTP/1.1協定中，所有的請求頭，除Host外，都是可選的。

### 用戶端請求
```http
GET / HTTP/1.1
Host: www.google.com
```
（末尾有一個空行。第一行指定方法、資源路徑、協定版本；第二行是在1.1版里必帶的一個header作用指定主機）

伺服器應答
```http
HTTP/1.1 200 OK
Content-Length: 3059
Server: GWS/2.0
Date: Sat, 11 Jan 2003 02:44:04 GMT
Content-Type: text/html
Cache-control: private
Set-Cookie: PREF=ID=73d4aef52e57bae9:TM=1042253044:LM=1042253044:S=SMCc_HRPCQiqy
X9j; expires=Sun, 17-Jan-2038 19:14:07 GMT; path=/; domain=.google.com
Connection: keep-alive
```
（緊跟著一個空行，並且由HTML格式的文字組成了Google的首頁）

資料來源<br />
[Wiki超文本傳輸協定](https://www.wikiwand.com/zh-tw/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE)